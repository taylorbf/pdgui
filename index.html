<html>
	<head>
		<meta charset="utf-8"></meta>
		<script src="js/jquery.js"></script>
		<script src="js/jquery-ui.js"></script>
		<script src="js/nexusUI.js"></script>
		<script src="js/webpd-latest.js"></script>
		<script src="js/pdgui.js"></script>
		<link rel="stylesheet" href="css/pdgui.css"></link>
	</head>
	<body>

		<script>


		var patch, patchData, gui;
		$(function() {

      $.get('pd/simple.pd', function(mainStr) {

        patchData = Pd.getPatchData(mainStr)

        patch = Pd.loadPatch(patchData)
        gui = GUI.loadPatch(patchData)
        
        Pd.start()

        var dummyObject = {patch: patch}
				    , receiver = new Pd.core.portlets.Inlet(dummyObject)

				// Overwriting the message method which will be called when a message has been sent by outlets upstream in the patch
				receiver.message = function(args) {
				    console.log(args)
				    toggle3.set({value:args[0]},false)
				}

				patch.objects[9].o(0).connect(receiver)

        //patch.objects[0].i(0).message([100])

      })
		})

		</script>

		<div id="objects"></div>
		<canvas id="connections"></canvas>

	</body>
</html>